# \u6267\u884C\u987A\u5E8F Retry > Bulkhead > RateLimiter > TimeLimiter > Bulkhead
resilience4j:
  # Resilience4j \u7684\u7194\u65AD\u5668\u914D\u7F6E\u9879\uFF0C\u5BF9\u5E94 CircuitBreakerProperties \u5C5E\u6027\u7C7B
  circuitbreaker:
    instances:
      #\u547D\u540D\u4E00\u4E2A\u7194\u65AD\u5668
      cbA:
        failure-rate-threshold: 50 # \u7194\u65AD\u5668\u5173\u95ED\u72B6\u6001\u548C\u534A\u5F00\u72B6\u6001\u4F7F\u7528\u7684\u540C\u4E00\u4E2A\u5931\u8D25\u7387\u9608\u503C\uFF0C\u5355\u4F4D\uFF1A\u767E\u5206\u6BD4\u3002\u9ED8\u8BA4\u4E3A 50
        ring-buffer-size-in-closed-state: 5 # \u7194\u65AD\u5668\u5173\u95ED\u72B6\u6001\u7684\u7F13\u51B2\u533A\u5927\u5C0F\uFF0C\u4E0D\u4F1A\u9650\u5236\u7EBF\u7A0B\u7684\u5E76\u53D1\u91CF\uFF0C\u5728\u7194\u65AD\u5668\u53D1\u751F\u72B6\u6001\u8F6C\u6362\u524D\u6240\u6709\u8BF7\u6C42\u90FD\u4F1A\u8C03\u7528\u540E\u7AEF\u670D\u52A1\u3002\u9ED8\u8BA4\u4E3A 100
        ring-buffer-size-in-half-open-state: 5 # \u7194\u65AD\u5668\u534A\u5F00\u72B6\u6001\u7684\u7F13\u51B2\u533A\u5927\u5C0F\uFF0C\u4F1A\u9650\u5236\u7EBF\u7A0B\u7684\u5E76\u53D1\u91CF\u3002\u4F8B\u5982\uFF0C\u7F13\u51B2\u533A\u4E3A 10 \u5219\u6BCF\u6B21\u53EA\u4F1A\u5141\u8BB8 10 \u4E2A\u8BF7\u6C42\u8C03\u7528\u540E\u7AEF\u670D\u52A1\u3002\u9ED8\u8BA4\u4E3A 10
        wait-duration-in-open-state : 5000 # \u7194\u65AD\u5668\u4ECE\u6253\u5F00\u72B6\u6001\u8F6C\u53D8\u4E3A\u534A\u5F00\u72B6\u6001\u7B49\u5F85\u7684\u65F6\u95F4\uFF0C\u5355\u4F4D\uFF1A\u5FAE\u79D2
        automatic-transition-from-open-to-half-open-enabled: true # \u5982\u679C\u7F6E\u4E3A true\uFF0C\u5F53\u7B49\u5F85\u65F6\u95F4\u7ED3\u675F\u4F1A\u81EA\u52A8\u7531\u6253\u5F00\u53D8\u4E3A\u534A\u5F00\uFF1B\u82E5\u7F6E\u4E3A false\uFF0C\u5219\u9700\u8981\u4E00\u4E2A\u8BF7\u6C42\u8FDB\u5165\u6765\u89E6\u53D1\u7194\u65AD\u5668\u72B6\u6001\u8F6C\u6362\u3002\u9ED8\u8BA4\u4E3A true
        register-health-indicator: true # \u662F\u5426\u6CE8\u518C\u5230\u5065\u5EB7\u76D1\u6D4B
  # Resilience4j \u7684\u9650\u6D41\u5668\u914D\u7F6E\u9879\uFF0C\u5BF9\u5E94 RateLimiterProperties \u5C5E\u6027\u7C7B
  ratelimiter:
    instances:
      #\u547D\u540D\u4E00\u4E2A\u9650\u6D41\u5668
      rlA:
        limit-for-period: 1 # \u6BCF\u4E2A\u5468\u671F\u5185\uFF0C\u5141\u8BB8\u7684\u8BF7\u6C42\u6570\u3002\u9ED8\u8BA4\u4E3A 50
        limit-refresh-period: 10s # \u6BCF\u4E2A\u5468\u671F\u7684\u65F6\u957F\uFF0C\u5355\u4F4D\uFF1A\u5FAE\u79D2\u3002\u9ED8\u8BA4\u4E3A 500
        timeout-duration: 5s # \u88AB\u9650\u6D41\u65F6\uFF0C\u963B\u585E\u7B49\u5F85\u7684\u65F6\u957F\uFF0C\u5355\u4F4D\uFF1A\u5FAE\u79D2\u3002\u9ED8\u8BA4\u4E3A 5s
        register-health-indicator: true # \u662F\u5426\u6CE8\u518C\u5230\u5065\u5EB7\u76D1\u6D4B
  # Resilience4j \u7684\u4FE1\u53F7\u91CF Bulkhead \u914D\u7F6E\u9879\uFF0C\u5BF9\u5E94 BulkheadConfigurationProperties \u5C5E\u6027\u7C7B
  bulkhead:
    instances:
      bhA:
        max-concurrent-calls: 1 # \u5E76\u53D1\u8C03\u7528\u6570\u3002\u9ED8\u8BA4\u4E3A 25
        max-wait-duration: 5s # \u5E76\u53D1\u8C03\u7528\u5230\u8FBE\u4E0A\u9650\u65F6\uFF0C\u963B\u585E\u7B49\u5F85\u7684\u65F6\u957F\uFF0C\u5355\u4F4D\uFF1A\u5FAE\u79D2\u3002\u9ED8\u8BA4\u4E3A 0
  # Resilience4j \u7684\u7EBF\u7A0B\u6C60 Bulkhead \u914D\u7F6E\u9879\uFF0C\u5BF9\u5E94 ThreadPoolBulkheadProperties \u5C5E\u6027\u7C7B
  thread-pool-bulkhead:
    instances:
      bhB:
        max-thread-pool-size: 1 # \u7EBF\u7A0B\u6C60\u7684\u6700\u5927\u5927\u5C0F\u3002\u9ED8\u8BA4\u4E3A Runtime.getRuntime().availableProcessors()
        core-thread-pool-size: 1 # \u7EBF\u7A0B\u6C60\u7684\u6838\u5FC3\u5927\u5C0F\u3002\u9ED8\u8BA4\u4E3A Runtime.getRuntime().availableProcessors() - 1
        queue-capacity: 100 # \u7EBF\u7A0B\u6C60\u7684\u961F\u5217\u5927\u5C0F\u3002\u9ED8\u8BA4\u4E3A 100
        keep-alive-duration: 100s # \u8D85\u8FC7\u6838\u5FC3\u5927\u5C0F\u7684\u7EBF\u7A0B\uFF0C\u7A7A\u95F2\u5B58\u6D3B\u65F6\u95F4\u3002\u9ED8\u8BA4\u4E3A 20 \u6BEB\u79D2
  # Resilience4j \u7684\u91CD\u8BD5 Retry \u914D\u7F6E\u9879\uFF0C\u5BF9\u5E94 RetryProperties \u5C5E\u6027\u7C7B
  retry:
    instances:
      trA:
        max-retry-Attempts: 3 # \u6700\u5927\u91CD\u8BD5\u6B21\u6570\u3002\u9ED8\u8BA4\u4E3A 3
        wait-duration: 5s # \u4E0B\u6B21\u91CD\u8BD5\u7684\u95F4\u9694\uFF0C\u5355\u4F4D\uFF1A\u5FAE\u79D2\u3002\u9ED8\u8BA4\u4E3A 500 \u6BEB\u79D2
        retry-exceptions: # \u9700\u8981\u91CD\u8BD5\u7684\u5F02\u5E38\u5217\u8868\u3002\u9ED8\u8BA4\u4E3A\u7A7A
        ignore-exceptions: # \u9700\u8981\u5FFD\u7565\u7684\u5F02\u5E38\u5217\u8868\u3002\u9ED8\u8BA4\u4E3A\u7A7A
  # Resilience4j \u7684\u8D85\u65F6\u9650\u5236\u5668 TimeLimiter \u914D\u7F6E\u9879\uFF0C\u5BF9\u5E94 TimeLimiterProperties \u5C5E\u6027\u7C7B
  timelimiter:
    instances:
      tlA:
        timeout-duration: 1s # \u7B49\u5F85\u8D85\u65F6\u65F6\u95F4\uFF0C\u5355\u4F4D\uFF1A\u5FAE\u79D2\u3002\u9ED8\u8BA4\u4E3A 1 \u79D2
        cancel-running-future: true # \u5F53\u7B49\u5F85\u8D85\u65F6\u65F6\uFF0C\u662F\u5426\u5173\u95ED\u53D6\u6D88\u7EBF\u7A0B\u3002\u9ED8\u8BA4\u4E3A true